{% extends "base.html" %}

{% block title %}AR Headset Simulation{% endblock %}

{% block styles %}
<style>
    .ar-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        text-align: center;
        color: var(--dark-color);
    }

    .ar-container.dark {
        color: white;
    }

    .ar-container h1 {
        color: var(--success-color);
        margin-bottom: 30px;
    }

    .video-container {
        position: relative;
        width: 640px;
        height: 480px;
        margin: 0 auto;
        border: 3px solid var(--success-color);
        border-radius: 8px;
        overflow: hidden;
    }

    #videoFeed {
        width: 100%;
        height: 100%;
        background-color: black;
    }

    .controls {
        margin-top: 20px;
    }

    .controls button {
        padding: 12px 24px;
        margin: 0 10px;
        border: none;
        border-radius: 4px;
        background-color: var(--success-color);
        color: white;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .controls button:hover {
        background-color: #45a049;
        transform: translateY(-2px);
    }

    #stopBtn {
        background-color: var(--error-color);
    }

    #stopBtn:hover {
        background-color: #d32f2f;
    }

    .instructions {
        margin-top: 20px;
        padding: 15px;
        background-color: var(--secondary-color);
        border-radius: 8px;
        text-align: left;
    }

    @media (max-width: 768px) {
        .video-container {
            width: 100%;
            height: auto;
            aspect-ratio: 4/3;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="ar-container">
    <h1>AR Headset Simulation</h1>

    <div class="video-container">
        <img id="videoFeed" src="{{ url_for('video_feed_headset') }}">
    </div>

    <div class="controls">
        <button id="stopBtn">Stop AR Headset</button>
    </div>

    <div class="instructions">
        <h3>How to use:</h3>
        <ul>
            <li>Speak naturally to see your words displayed in AR</li>
            <li>The system will automatically recognize your speech</li>
            <li>Green corners indicate the AR headset display area</li>
            <li>Status indicator shows listening state (green=ready, yellow=listening, red=error)</li>
        </ul>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('stopBtn').addEventListener('click', function() {
        fetch('/stop_headset', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                window.location.href = '/';
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    });
</script>
{% endblock %}